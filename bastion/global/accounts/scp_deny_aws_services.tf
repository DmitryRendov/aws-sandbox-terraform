# Deny unexpected services
data "aws_iam_policy_document" "deny_aws_services" {
  statement {
    sid = "DenyAwsServices"

    actions = [
      "*"
    ]

    resources = [
      "a4b:*",
      "access-analyzer:*",
      "account:*",
      "amplify:*",
      "applicationinsights:*",
      "appmesh:*",
      "appmesh-preview:*",
      "appstream:*",
      "appsync:*",
      "arsenal:*",
      "artifact:*",
      "aws-marketplace:*",
      "aws-marketplace-management:*",
      "aws-portal:*",
      "backup:*",
      "backup-storage:*",
      "budgets:*",
      "cassandra:*",
      "ce:*",
      "chatbot:*",
      "chime:*",
      "cloudhsm:*",
      "comprehendmedical:*",
      "compute-optimizer:*",
      "connect:*",
      "cur:*",
      "dataexchange:*",
      "datasync:*",
      "dbqms:*",
      "deeplens:*",
      "deepracer:*",
      "detective:*",
      "devicefarm:*",
      "directconnect:*",
      "dlm:*",
      "ebs:*",
      "ec2-instance-connect:*",
      "ec2messages:*",
      "elastic-inference:*",
      "execute-api:*",
      "fms:*",
      "forecast:*",
      "frauddetector:*",
      "freertos:*",
      "fsx:*",
      "gamelift:*",
      "glacier:*",
      "globalaccelerator:*",
      "groundstation:*",
      "groundtruthlabeling:*",
      "imagebuilder:*",
      "importexport:*",
      "iot-device-tester:*",
      "iotevents:*",
      "iotsitewise:*",
      "iotthingsgraph:*",
      "kendra:*",
      "kinesisanalytics:*",
      "lakeformation:*",
      "launchwizard:*",
      "license-manager:*",
      "lightsail:*",
      "logs:*",
      "macie:*",
      "managedblockchain:*",
      "mechanicalturk:*",
      "mediaconnect:*",
      "mediaconvert:*",
      "medialive:*",
      "mediapackage:*",
      "mediapackage-vod:*",
      "mediastore:*",
      "mediatailor:*",
      "mobileanalytics:*",
      "mobilehub:*",
      "mobiletargeting:*",
      "mq:*",
      "neptune-db:*",
      "networkmanager:*",
      "organizations:*",
      "outposts:*",
      "personalize:*",
      "pricing:*",
      "qldb:*",
      "quicksight:*",
      "ram:*",
      "robomaker:*",
      "sagemaker:*",
      "savingsplans:*",
      "schemas:*",
      "sdb:*",
      "serverlessrepo:*",
      "servicecatalog:*",
      "servicediscovery:*",
      "servicequotas:*",
      "shield:*",
      "signer:*",
      "sms-voice:*",
      "snowball:*",
      "ssmmessages:*",
      "sso:*",
      "sso-directory:*",
      "storagegateway:*",
      "sumerian:*",
      "support:*",
      "swf:*",
      "synthetics:*",
      "transfer:*",
      "trustedadvisor:*",
      "wafv2:*",
      "wam:*",
      "wellarchitected:*",
      "workdocs:*",
      "worklink:*",
      "workmail:*",
      "workmailmessageflow:*",
      "workspaces:*"
    ]

    effect = "Deny"

  }
}

